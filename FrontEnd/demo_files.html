<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>Titre de la page</title>
    <style>
        .container {

            margin: 100px;
        
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .image {
            width: 500px;
            height: 300px;
            background: lightgray;
   
        }

        #image{
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        input {
            margin-top: 25px;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="image">
        <img src="" alt="" id="image"/>
    </div>
    <input type="file" id="myFile">
    <p id="fileError"></p>
</div>


<script>

    const myFileBtn = document.querySelector('#myFile');

    myFileBtn.addEventListener('change', function () {

        const fileError = document.querySelector('#fileError');
        const image = document.querySelector('#image');
        const myFile = myFileBtn.files[0]; // On récupère le premier fichier dans l'input
        console.log(myFile)
        const reader = new FileReader(); // On créer notre objet qui permetde lire des fichiers


        if (myFile) {

            // MORE N°1 : Vérifier que le fichier est inférieur à X mo
            // MORE N°2 : Vérifier que le fichier est aussi suppérieur à X ko
            // MORE N°3 : Vérifier que le fichier à JPEG et PNG en format UNIQUEMENT
            
            
            // MORE N°4 (plus dure) :  Vérifier que le fichier a été modifier il y a moins de 3 jours


            // Attention on est ici en bytes il faut converir mo => octets
            const SIZE_2MO = 2097152;
            if(myFile.size > SIZE_2MO){
                fileError.innerHTML = 'Le fichier est trop lourd';
                myFile.value = ''; // On reset l'input

            } else {
                fileError.innerHTML = '';

                console.log(myFile)
                //'il y a bien un fichier, on lance la demande de lecture du fichier
                reader.readAsDataURL(myFile);
            }
        } else {

            // Si il n'y a pas de fichier on vide la source de l'image est réinitialisée
            image.src = '';
        }

        /**
         * Event qui est déclanché quand le fichier est finis de lire
         */
        reader.onloadend = function () {
            console.log(reader.result)
            image.src = reader.result; // On remplace la source de l'image par le contenu du fichier en base 64
        }

    });

</script>
</body>
</html>